{% load static %}
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>{% block title %}Venyuk!{% endblock title %}</title>
    {% block meta %} {% endblock meta %}
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/dompurify@3.0.5/dist/purify.min.js"></script>
  </head>
  <body>
    {% block content %} {% endblock content %}
  
  <!-- Toast -->
  <div id="toast" class="fixed top-5 right-5 hidden z-[9999]">
    <div id="toastContent" class="bg-gray-800 text-white px-5 py-3 rounded-lg shadow-lg"></div>
  </div>

  <script>
    function showToast(message, success=true) {
      const toast = document.getElementById('toast');
      const toastContent = document.getElementById('toastContent');
      toastContent.textContent = message;
      toastContent.className = success 
        ? "bg-green-600 text-white px-5 py-3 rounded-lg shadow-lg"
        : "bg-red-600 text-white px-5 py-3 rounded-lg shadow-lg";

      toast.classList.remove('hidden');
      setTimeout(() => { toast.classList.add('hidden'); }, 3000);
    }

    // Modal control
    document.getElementById("closeLoginModal")?.addEventListener("click", () => {
      document.getElementById("loginModal")?.classList.add("hidden");
    });
    document.getElementById("openLoginModal")?.addEventListener("click", () => {
      document.getElementById("loginModal")?.classList.remove("hidden");
    });

    const data = await response.json();
    if (response.ok && data.status) {
      showToast("Login berhasil! Selamat datang, " + data.username);
      document.getElementById("loginModal").classList.add("hidden");
      // Optionally reload navbar or page
      setTimeout(() => location.reload(), 1500);
    } else {
      showToast(data.message || "Login gagal!", false);
    }
  });
</script>
</body>
</html>
