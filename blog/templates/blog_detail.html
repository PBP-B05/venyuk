{% extends 'base.html' %}
{% block content %}
{% include 'navbar.html' %}

<style>
  input[type="text"],input[type="url"], textarea, select, input[type="file"] {
    border: 1px solid #d1d5db;
    border-radius: 0.5rem;
    padding: 0.5rem 0.75rem;
    width: 100%;
    box-sizing: border-box;
    margin-bottom: 0.5rem;
  }
  input:focus, textarea:focus, select:focus, input[type="url"]:focus {
    outline: none;
    border-color: #b91c1c;
 }
</style>

<div class="max-w-3xl mx-auto px-4 py-10">

  <!-- Tombol Back -->
  <p class="mb-6">
    <a href="{% url 'blog:show_blogmain' %}" class="text-red-700 hover:text-red-900 font-semibold">
      ← Back to Blog Main
    </a>
  </p>

  <!-- Judul Blog -->
  <h1 class="text-3xl font-bold text-red-700 mb-2">{{ blog.title }}</h1>
  <p class="text-sm text-gray-500 mb-4">
    <b class="text-red-700">{{ blog.get_category_display }}</b> • 
    <i>{{ blog.created_at|date:"d M Y, H:i" }}</i> • 
    Views: {{ blog.blog_views }}
  </p>

  <!-- Thumbnail -->
  {% if blog.thumbnail %}
    <div class="mb-6">
      <img src="{{ blog.thumbnail }}" alt="Blog thumbnail" class="rounded-lg shadow-md w-full max-h-96 object-cover">
    </div>
  {% endif %}

  <!-- Konten Blog -->
  <div class="prose max-w-none text-gray-800 leading-relaxed mb-10">
    {{ blog.content }}
  </div>

  <hr class="my-8 border-gray-300">

  <!-- Section Comments -->
{% if user.is_authenticated %}
  <h2 class="text-2xl font-bold text-red-700 mb-6">Comments</h2>
  {% if comments %}
    <div class="space-y-4 mb-10">
      {% for comment in comments %}
        <div class="bg-gray-50 border border-gray-200 rounded-lg p-4 shadow-sm">
          <div class="flex justify-between items-center mb-1">
            <b class="text-red-700">{{ comment.user.username }}</b>
            <span class="text-xs text-gray-400">{{ comment.created_at|date:"d M Y, H:i" }}</span>
          </div>
          <p class="text-gray-700">{{ comment.content }}</p>
        </div>
      {% endfor %}
    </div>
  {% else %}
    <p class="text-gray-500 mb-10">No comments yet.</p>
    {% endif %}
  {% endif %}


  <!-- Form Tambah Komentar -->
  {% if user.is_authenticated %}
    <form method="POST" class="bg-white rounded-lg shadow-md p-6 border border-gray-200">
      {% csrf_token %}
      <label for="{{ form.content.id_for_label }}" class="block text-sm font-medium text-gray-700 mb-2">
        Leave a Comment
      </label>
      {{ form.content }}
      <button type="submit" class="mt-4 bg-red-700 text-white px-5 py-2 rounded-lg font-semibold hover:bg-red-800 transition">
        Add Comment
      </button>
    </form>
  {% else %}
    <div class="bg-gray-50 p-6 rounded-lg border border-gray-200 text-center">
      <p class="text-gray-600">
        Please 
        <a href="{% url 'authenticate:login' %}" class="text-red-700 font-semibold hover:underline">
          login
        </a> 
        to view comment.
      </p>
    </div>
  {% endif %}
</div>

{% endblock content %}